{"ast":null,"code":"import { HttpHeaders, HttpParams } from '@angular/common/http';\nimport { jwtDecode } from 'jwt-decode';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nclass AuthentifcationService {\n  constructor(http, router) {\n    this.http = http;\n    this.router = router;\n    this.isAuthenticated = false;\n  }\n  login(username, password) {\n    let options = {\n      headers: new HttpHeaders().set(\"Content-Type\", \"application/x-www-form-urlencoded\")\n    };\n    let params = new HttpParams().set(\"username\", username).set(\"password\", password);\n    return this.http.post(\"http://localhost:8085/auth/login\", params, options);\n  }\n  loadProfile(data) {\n    this.isAuthenticated = true;\n    this.accessToken = data['access-token'];\n    let decodedJwt = jwtDecode(this.accessToken);\n    this.username = decodedJwt.sub;\n    this.roles = decodedJwt.scope;\n    window.localStorage.setItem(\"jwt-token\", this.accessToken);\n  }\n  logout() {\n    this.isAuthenticated = false;\n    this.accessToken = undefined;\n    this.username = undefined;\n    this.roles = undefined;\n  }\n  loadJwtTokenFromLocalStorage() {\n    let token = window.localStorage.getItem(\"jwt-token\");\n    if (token) {\n      this.loadProfile({\n        \"access-token\": token\n      });\n      this.router.navigateByUrl(\"/admin/manager\");\n    }\n  }\n  static #_ = this.ɵfac = function AuthentifcationService_Factory(t) {\n    return new (t || AuthentifcationService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Router));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: AuthentifcationService,\n    factory: AuthentifcationService.ɵfac,\n    providedIn: 'root'\n  });\n}\nexport { AuthentifcationService };","map":{"version":3,"names":["HttpHeaders","HttpParams","jwtDecode","AuthentifcationService","constructor","http","router","isAuthenticated","login","username","password","options","headers","set","params","post","loadProfile","data","accessToken","decodedJwt","sub","roles","scope","window","localStorage","setItem","logout","undefined","loadJwtTokenFromLocalStorage","token","getItem","navigateByUrl","_","i0","ɵɵinject","i1","HttpClient","i2","Router","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\ASUS\\angularPfe\\ProjetPfe\\src\\app\\services\\authentifcation.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\n//import { UntypedFormBuilder } from '@angular/forms';\n//import { Observable, of, throwError } from 'rxjs';\nimport { __values } from 'tslib';\n\nimport { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { jwtDecode } from 'jwt-decode';\nimport { Router } from '@angular/router';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuthentifcationService {\n  isAuthenticated : boolean =false;\n  roles : any;\n  username : any;\n  accessToken!: any;\n\n  constructor(private  http:HttpClient,private router:Router){}\n   \n   public login(username : string , password:string){\n    let options ={\n      headers : new HttpHeaders().set(\"Content-Type\",\"application/x-www-form-urlencoded\")\n    }\n    let params=new HttpParams().set(\"username\",username).set(\"password\",password);\n     return this .http.post(\"http://localhost:8085/auth/login\" ,params,options)\n   }\n   loadProfile(data:any){\n    this.isAuthenticated=true;\n    this.accessToken=data['access-token'];\n    let decodedJwt:any = jwtDecode(this.accessToken);\n    this.username= decodedJwt.sub;\n    this.roles=decodedJwt.scope;\n    window.localStorage.setItem(\"jwt-token\",this.accessToken);\n   }\n   logout(){\n    this.isAuthenticated=false;\n    this.accessToken=undefined;\n    this.username=undefined;\n    this.roles=undefined;\n   }\n   loadJwtTokenFromLocalStorage(){\n    let token=window.localStorage.getItem(\"jwt-token\");\n    if(token){\n      this.loadProfile({\"access-token\":token});\n      this.router.navigateByUrl(\"/admin/manager\")\n    }\n\n   }\n  }"],"mappings":"AAMA,SAAqBA,WAAW,EAAEC,UAAU,QAAQ,sBAAsB;AAC1E,SAASC,SAAS,QAAQ,YAAY;;;;AAGtC,MAGaC,sBAAsB;EAMjCC,YAAqBC,IAAe,EAASC,MAAa;IAArC,KAAAD,IAAI,GAAJA,IAAI;IAAoB,KAAAC,MAAM,GAANA,MAAM;IALnD,KAAAC,eAAe,GAAY,KAAK;EAK4B;EAEpDC,KAAKA,CAACC,QAAiB,EAAGC,QAAe;IAC/C,IAAIC,OAAO,GAAE;MACXC,OAAO,EAAG,IAAIZ,WAAW,EAAE,CAACa,GAAG,CAAC,cAAc,EAAC,mCAAmC;KACnF;IACD,IAAIC,MAAM,GAAC,IAAIb,UAAU,EAAE,CAACY,GAAG,CAAC,UAAU,EAACJ,QAAQ,CAAC,CAACI,GAAG,CAAC,UAAU,EAACH,QAAQ,CAAC;IAC5E,OAAO,IAAI,CAAEL,IAAI,CAACU,IAAI,CAAC,kCAAkC,EAAED,MAAM,EAACH,OAAO,CAAC;EAC5E;EACAK,WAAWA,CAACC,IAAQ;IACnB,IAAI,CAACV,eAAe,GAAC,IAAI;IACzB,IAAI,CAACW,WAAW,GAACD,IAAI,CAAC,cAAc,CAAC;IACrC,IAAIE,UAAU,GAAOjB,SAAS,CAAC,IAAI,CAACgB,WAAW,CAAC;IAChD,IAAI,CAACT,QAAQ,GAAEU,UAAU,CAACC,GAAG;IAC7B,IAAI,CAACC,KAAK,GAACF,UAAU,CAACG,KAAK;IAC3BC,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,WAAW,EAAC,IAAI,CAACP,WAAW,CAAC;EAC1D;EACAQ,MAAMA,CAAA;IACL,IAAI,CAACnB,eAAe,GAAC,KAAK;IAC1B,IAAI,CAACW,WAAW,GAACS,SAAS;IAC1B,IAAI,CAAClB,QAAQ,GAACkB,SAAS;IACvB,IAAI,CAACN,KAAK,GAACM,SAAS;EACrB;EACAC,4BAA4BA,CAAA;IAC3B,IAAIC,KAAK,GAACN,MAAM,CAACC,YAAY,CAACM,OAAO,CAAC,WAAW,CAAC;IAClD,IAAGD,KAAK,EAAC;MACP,IAAI,CAACb,WAAW,CAAC;QAAC,cAAc,EAACa;MAAK,CAAC,CAAC;MACxC,IAAI,CAACvB,MAAM,CAACyB,aAAa,CAAC,gBAAgB,CAAC;;EAG9C;EAAC,QAAAC,CAAA,G;qBApCS7B,sBAAsB,EAAA8B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,MAAA;EAAA;EAAA,QAAAC,EAAA,G;WAAtBpC,sBAAsB;IAAAqC,OAAA,EAAtBrC,sBAAsB,CAAAsC,IAAA;IAAAC,UAAA,EAFrB;EAAM;;SAEPvC,sBAAsB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}